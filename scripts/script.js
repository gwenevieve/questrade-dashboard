$(document).ready(function(){var t;new EventSource("/watchlist").onmessage=function(e){let a=JSON.parse(e.data);$.each(a,function(e,a){let l="",i="",s="",c="",o="";checkMarketStatus(),$.each(a,function(e,a){l+=`<li>${a.symbol}</li>`,1==t?(i+=`<li>${a.openPrice}</li>`,s+=`<li>${a.highPrice}</li>`,c+=`<li>${a.lowPrice}</li>`):(i+="<li>--</li>",s+="<li>--</li>",c+="<li>--</li>"),1==t&&this.openPrice>this.lastTradePrice==1?o+=`<li><span data-value="gain">${a.lastTradePrice}</span></li>`:1==t&&this.openPrice<this.lastTradePrice==1?o+=`<li><span data-value="loss">${a.lastTradePrice}</span></li>`:o+=`<li><span data-value="closed">${a.lastTradePrice}</span></li>`,$(".watchlistName").html(l),$(".watchlistLastTradePrice").html(o),$(".watchlistOpenPrice").html(i),$(".watchlistHighPrice").html(s),$(".watchlistLowPrice").html(c)})})},fetch("/chartinfo",{}).then(t=>t.json()).then(t=>{let e=t;$.each(e,function(t,a){results=a,$.each(e,function(t,e){BABA=e[0].totalCost,CRON=e[1].totalCost})}),chartDisplay()}).catch(t=>console.log(t)),$(".search__submit").on("click",function(t){t.preventDefault(),$(".search__submit").prop("disabled",!0),setTimeout(function(){$(".search__submit").prop("disabled",!1)},1e3),$.ajax({url:"/search",type:"GET",data:{symbol:$("#search").val()},success:function(t){let e="",a="",l="";$.each(t,function(t,i){if(7===t)return!1;e+=`<li>${i.symbol}</li>`,a+=`<li>${i.symbolId}</li>`,l+=`<li>${i.description}</li>`,$(".name").html(e),$(".symbolId").html(a),$(".symbolDesc").html(l)})},error:console.error})}),chartDisplay=(()=>{let t=document.getElementById("myChart").getContext("2d");myChart=new Chart(t,{type:"doughnut",data:{labels:["BABA","CRON"],datasets:[{fill:!0,backgroundColor:["#6825c3","#8F42F4"],data:[BABA,CRON]}]},options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{bottom:50}}}})}),checkMarketStatus=(()=>{let e=moment("09:30:00","HH:mm:ss"),a=moment("16:00:00","HH:mm:ss");1==moment().isBetween(e,a)?(t=!0,$(".marketStatus").html("Open").css("color","#31c331")):(t=!1,$(".marketStatus").html("Closed").css("color","red"))})});